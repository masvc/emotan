# AquaSync ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¼•ãç¶™ãè³‡æ–™

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**AquaSync**ã¯ã€IoT ã‚»ãƒ³ã‚µãƒ¼ã‚’ä½¿ç”¨ã—ãŸæ°´åˆ†ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚Arduino ã‚»ãƒ³ã‚µãƒ¼ã‹ã‚‰æ°´åˆ†ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚¯ãƒ©ã‚¦ãƒ‰ã«é€ä¿¡ã€‚å¦–ç²¾ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã€Œãˆã‚‚ãŸã‚“ã€ãŒå¯æ„›ãçŠ¶æ³ã‚’æ•™ãˆã¦ãã‚Œã‚‹ Web ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’æä¾›ã—ã¾ã™ã€‚

### ğŸ¯ ä¸»ãªæ©Ÿèƒ½

- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ°´åˆ†ãƒ¬ãƒ™ãƒ«ç›£è¦–** - Arduino ã‚»ãƒ³ã‚µãƒ¼ã«ã‚ˆã‚‹æ°´åˆ†æ¸¬å®š
- **å¦–ç²¾ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã€Œãˆã‚‚ãŸã‚“ã€** - 5 ç¨®é¡ã®è¡¨æƒ…ã§çŠ¶æ³ã‚’è¡¨ç¾
- **éŸ³å£°æ©Ÿèƒ½** - çŠ¶æ…‹å¤‰åŒ–æ™‚ã®éŸ³å£°å†ç”Ÿï¼ˆON/OFF åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ï¼‰
- **LINE é€šçŸ¥** - æ°´åˆ†çŠ¶æ…‹ã®å¤‰åŒ–ã‚’ LINE ã§é€šçŸ¥
- **AI ç”Ÿæˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸** - Gemini API ã«ã‚ˆã‚‹è‡ªç„¶ãªã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚»ãƒªãƒ•
- **ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** - Render ä¸Šã§ç¨¼åƒã™ã‚‹ Web ã‚¢ãƒ—ãƒª
- **RESTful API** - ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»æ›´æ–°ç”¨ API
- **ãƒ­ãƒ¼ã‚«ãƒ«ã‚»ãƒ³ã‚µãƒ¼åˆ¶å¾¡** - Arduino ã¨ã®ã‚·ãƒªã‚¢ãƒ«é€šä¿¡

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ãƒ­ãƒ¼ã‚«ãƒ«å´    â”‚â”€â”€â”€â”€â”‚   ã‚¯ãƒ©ã‚¦ãƒ‰å´    â”‚â”€â”€â”€â”€â”‚   ãƒ¦ãƒ¼ã‚¶ãƒ¼      â”‚
â”‚ (ã‚»ãƒ³ã‚µãƒ¼+åˆ¶å¾¡) â”‚    â”‚ (Webãƒ€ãƒƒã‚·ãƒ¥    â”‚    â”‚ (ãƒ–ãƒ©ã‚¦ã‚¶)      â”‚
â”‚                 â”‚    â”‚  ãƒœãƒ¼ãƒ‰)        â”‚    â”‚                 â”‚
â”‚ local_sensor.py â”‚â”€â”€â”€â”€â”‚web_dashboard.py â”‚â”€â”€â”€â”€â”‚ https://emotan. â”‚
â”‚ Arduino/ã‚»ãƒ³ã‚µãƒ¼â”‚    â”‚ (Render)        â”‚    â”‚ onrender.com    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Backend**: Python Flask + Gunicorn
- **Frontend**: HTML/CSS/JavaScript (å¦–ç²¾ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ + éŸ³å£°æ©Ÿèƒ½)
- **Cloud**: Render (Web ã‚µãƒ¼ãƒ“ã‚¹)
- **IoT**: Arduino + Python (ã‚·ãƒªã‚¢ãƒ«é€šä¿¡)
- **API**: RESTful JSON API + Bearer èªè¨¼
- **AI**: Google Gemini API (ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚»ãƒªãƒ•ç”Ÿæˆ)
- **é€šçŸ¥**: LINE Messaging API
- **éŸ³å£°**: WAV å½¢å¼éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
emotan/
â”œâ”€â”€ ğŸ“„ web_dashboard.py          # ãƒ¡ã‚¤ãƒ³ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ ğŸ“„ local_sensor.py           # ãƒ­ãƒ¼ã‚«ãƒ«ã‚»ãƒ³ã‚µãƒ¼åˆ¶å¾¡ + LINEé€šçŸ¥
â”œâ”€â”€ ğŸ“„ local_sensor_test.py      # ã‚¯ãƒ©ã‚¦ãƒ‰æ¥ç¶šãƒ†ã‚¹ãƒˆç”¨
â”œâ”€â”€ ğŸ“„ AquaSync.ino              # Arduinoæ°´åˆ†ã‚»ãƒ³ã‚µãƒ¼ã‚³ãƒ¼ãƒ‰
â”œâ”€â”€ ğŸ“„ requirements.txt          # Pythonä¾å­˜é–¢ä¿‚
â”œâ”€â”€ ğŸ“„ readme.md                 # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè³‡æ–™
â”œâ”€â”€ ğŸ–¼ï¸ img/                      # ç”»åƒãƒªã‚½ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ back.jpg                 # èƒŒæ™¯ç”»åƒ
â”‚   â”œâ”€â”€ yousei1.png              # å¦–ç²¾(é€šå¸¸)
â”‚   â”œâ”€â”€ yousei2.png              # å¦–ç²¾(è­¦æˆ’)
â”‚   â”œâ”€â”€ yousei3.png              # å¦–ç²¾(è¿½åŠ )
â”‚   â”œâ”€â”€ yousei4.png              # å¦–ç²¾(å…ƒæ°—)
â”‚   â””â”€â”€ yousei5.png              # å¦–ç²¾(æ€’ã‚Š)
â”œâ”€â”€ ğŸ”Š voice/                    # éŸ³å£°ãƒªã‚½ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ arigatou.wav             # ã‚ã‚ŠãŒã¨ã†éŸ³å£°
â”‚   â”œâ”€â”€ kora.wav                 # ã“ã‚‰éŸ³å£°
â”‚   â”œâ”€â”€ nice.wav                 # ãƒŠã‚¤ã‚¹éŸ³å£°
â”‚   â”œâ”€â”€ ohayo.wav                # ãŠã¯ã‚ˆã†éŸ³å£°
â”‚   â”œâ”€â”€ omizu.wav                # ãŠæ°´éŸ³å£°
â”‚   â”œâ”€â”€ yatta.wav                # ã‚„ã£ãŸéŸ³å£°
â”‚   â””â”€â”€ yorosiku.wav             # ã‚ˆã‚ã—ãéŸ³å£°
â””â”€â”€ ğŸ“ venv/                     # Pythonä»®æƒ³ç’°å¢ƒ
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ç’°å¢ƒ

### ğŸŒ æœ¬ç•ªç’°å¢ƒ (Render)

- **URL**: https://emotan.onrender.com
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ç¨¼åƒä¸­ âœ…
- **ã‚µãƒ¼ãƒãƒ¼**: Gunicorn + Flask
- **è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤**: GitHub é€£æº

### ğŸ“Š ä¸»è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

- `GET /` - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆå¦–ç²¾ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨ç¤ºï¼‰
- `GET /api/data` - ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿å–å¾—
- `POST /api/update` - ãƒ‡ãƒ¼ã‚¿æ›´æ–° (Bearer èªè¨¼å¿…é ˆ)
- `GET /health` - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- `GET /img/<filename>` - ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡
- `GET /voice/<filename>` - éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡

## âš™ï¸ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd emotan

# ä»®æƒ³ç’°å¢ƒä½œæˆ
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆ.envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼‰
# ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š
# API_SECRET_KEY=your-secret-key
# CLOUD_API_URL=https://emotan.onrender.com
# CHANNEL_ACCESS_TOKEN=your-line-token
# GEMINI_API_KEY=your-gemini-key
# ARDUINO_PORT=/dev/tty.usbserial-xxxxx

# ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œ
python web_dashboard.py
```

### 2. Arduino ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Arduino IDEã§AquaSync.inoã‚’é–‹ã
# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š
# - Servo
# - TM1637Display

# Arduinoã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
# ã‚·ãƒªã‚¢ãƒ«ãƒ¢ãƒ‹ã‚¿ã§å‹•ä½œç¢ºèª
```

### 3. ã‚»ãƒ³ã‚µãƒ¼æ¥ç¶š (ãƒ­ãƒ¼ã‚«ãƒ«å´)

```bash
# ã‚¯ãƒ©ã‚¦ãƒ‰æ¥ç¶šãƒ†ã‚¹ãƒˆ
python local_sensor_test.py

# ã‚»ãƒ³ã‚µãƒ¼ç›£è¦–é–‹å§‹ï¼ˆLINEé€šçŸ¥ä»˜ãï¼‰
python local_sensor.py
```

## ğŸŒ Render ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### åˆå›ãƒ‡ãƒ—ãƒ­ã‚¤

1. Render ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
2. GitHub é€£æº
3. Web Service ä½œæˆ
4. ä»¥ä¸‹ã®è¨­å®š:

```
Build Command: pip install -r requirements.txt
Start Command: gunicorn --bind 0.0.0.0:$PORT web_dashboard:app
```

### Environment Variables

```
API_SECRET_KEY=your-secret-key
RENDER_EXTERNAL_URL=https://emotan.onrender.com
```

### æ›´æ–°ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
git add .
git commit -m "Update message"
git push origin main  # è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™
```

## ğŸ“¡ API ä»•æ§˜

### GET /api/data

ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹:**

```json
{
  "raw_value": 450,
  "percentage": 75,
  "status": "yellow",
  "last_update": "2025-01-15T12:30:45",
  "message": "ğŸŸ¡ æ¤ç‰©ã®æ°´åˆ†ã¯é©åº¦ (12:30)\nğŸ’§ æ°´åˆ†ãƒ¬ãƒ™ãƒ«: 75%\nâœ… è‰¯å¥½ãªçŠ¶æ…‹ã§ã™",
  "character_message": "75%ã§ãã“ãã“å…ƒæ°—ã ã‚ˆã€œï¼ã‚ãªãŸã®ãŠã‹ã’ã ã­â™ª",
  "character_face": "yousei2"
}
```

### POST /api/update

ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–° (è¦ API Key)

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹:**

```json
{
  "raw_value": 450,
  "percentage": 75,
  "status": "yellow",
  "message": "ğŸŸ¡ æ¤ç‰©ã®æ°´åˆ†ã¯é©åº¦ (12:30)\nğŸ’§ æ°´åˆ†ãƒ¬ãƒ™ãƒ«: 75%\nâœ… è‰¯å¥½ãªçŠ¶æ…‹ã§ã™",
  "character_message": "75%ã§ãã“ãã“å…ƒæ°—ã ã‚ˆã€œï¼ã‚ãªãŸã®ãŠã‹ã’ã ã­â™ª",
  "character_face": "yousei2"
}
```

**ãƒ˜ãƒƒãƒ€ãƒ¼:**

```
Authorization: Bearer your-api-secret-key
Content-Type: application/json
```

## ğŸ” ç›£è¦–ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ­ã‚°ç¢ºèª

```bash
# Renderãƒ­ã‚°
https://dashboard.render.com â†’ Logs ã‚¿ãƒ–

# ãƒ­ãƒ¼ã‚«ãƒ«ãƒ­ã‚°
tail -f console.log
```

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### 1. ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**ç—‡çŠ¶**: Render deploy æ™‚ã«ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
**è§£æ±º**: Start Command ã‚’ç¢ºèª

```bash
# âŒ é–“é•ã„
python web_dashboard.py

# âœ… æ­£è§£
gunicorn --bind 0.0.0.0:$PORT web_dashboard:app
```

#### 2. API èªè¨¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: 401 Unauthorized
**è§£æ±º**: Bearer èªè¨¼ã‚’ç¢ºèª

```python
headers = {'Authorization': 'Bearer your-secret-key'}
```

#### 3. ã‚»ãƒ³ã‚µãƒ¼æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: ã‚·ãƒªã‚¢ãƒ«é€šä¿¡å¤±æ•—
**è§£æ±º**: ãƒãƒ¼ãƒˆç¢ºèª

```python
# ãƒ‡ãƒã‚¤ã‚¹ç¢ºèª
ls /dev/tty*  # Mac/Linux
# ãƒ‡ãƒã‚¤ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ç¢ºèª (Windows)
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

- **å¿œç­”æ™‚é–“**: < 2 ç§’
- **ç¨¼åƒç‡**: 99%+
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: < 512MB

## ğŸ“ˆ ä»Šå¾Œã®æ”¹å–„æ¡ˆ

### ğŸ”§ æŠ€è¡“çš„æ”¹å–„

- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¿½åŠ  (PostgreSQL)
- [ ] å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ãƒ»ã‚°ãƒ©ãƒ•è¡¨ç¤º
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ (WebSocket)
- [ ] ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªå¯¾å¿œ
- [ ] Docker åŒ–
- [ ] è¤‡æ•°ã‚»ãƒ³ã‚µãƒ¼å¯¾å¿œ
- [ ] è‡ªå‹•æ°´ã‚„ã‚Šã‚·ã‚¹ãƒ†ãƒ é€£æº

### ğŸ¨ UI/UX æ”¹å–„

- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- [ ] ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰
- [ ] ã‚°ãƒ©ãƒ•è¡¨ç¤ºæ©Ÿèƒ½
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
- [ ] ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] éŸ³å£°è¨­å®šã®æ°¸ç¶šåŒ–

### ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–

- [ ] HTTPS å¼·åˆ¶
- [ ] Rate limiting
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼
- [ ] API ç‰ˆç®¡ç†

## ğŸ“ ã‚µãƒãƒ¼ãƒˆæƒ…å ±

### ğŸ”— é‡è¦ãªãƒªãƒ³ã‚¯

- **æœ¬ç•ªã‚µã‚¤ãƒˆ**: https://emotan.onrender.com
- **Render Dashboard**: https://dashboard.render.com
- **GitHub**: <repository-url>

### ğŸ“± ç·Šæ€¥é€£çµ¡å…ˆ

- **é–‹ç™ºè€…**: [é€£çµ¡å…ˆæƒ…å ±]
- **Render ã‚µãƒãƒ¼ãƒˆ**: https://render.com/docs

### ğŸ“š å‚è€ƒè³‡æ–™

- [Flask Documentation](https://flask.palletsprojects.com/)
- [Gunicorn Documentation](https://gunicorn.org/)
- [Render Documentation](https://render.com/docs)

---

## ğŸ“ æ›´æ–°å±¥æ­´

| æ—¥ä»˜       | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹                             |
| ---------- | ---------- | ------------------------------------ |
| 2025-01-15 | v1.0       | åˆå›ãƒªãƒªãƒ¼ã‚¹ã€Render ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†    |
| 2025-01-15 | v1.1       | Gunicorn æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼å°å…¥            |
| 2025-01-15 | v1.2       | éŸ³å£°æ©Ÿèƒ½ã€LINE é€šçŸ¥ã€Gemini API è¿½åŠ  |
| 2025-01-15 | v1.3       | Arduino çµ±åˆã€5 ç¨®é¡ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å¯¾å¿œ |

---

**Last Updated**: 2025-01-15  
**Document Version**: 1.3  
**Project Status**: Production Ready âœ…
